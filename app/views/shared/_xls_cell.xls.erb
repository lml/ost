<%# Copyright 2011-2012 Rice University. Licensed under the Affero General Public 
    License version 3 or later.  See the COPYRIGHT file for details. %>

<%
  type = case type
         when :string
           "String"
         when :number
           "Number"
         end      
  comment ||= nil
  formula ||= nil
  style ||= nil

  settings ||= {
    :author => "OpenStax Tutor",
    :comments => {
      :size => 9,
      :color => '#000000'
    }
  }
%>

      
        <Cell <%= "ss:StyleID='#{style}'" if !style.nil? %> <%= "ss:Formula='#{formula}'" if !formula.nil? %> >
          <Data ss:Type="<%= type %>"><%= body %></Data>
        <% if !comment.nil? %>
          <Comment ss:Author="<%= settings[:author] %>">
            <Data><Font html:Size="<%= settings[:comments][:size] %>" 
                    html:Color="<%= settings[:comments][:color] %>" 
                    xmlns="http://www.w3.org/TR/REC-html40"><%= comment[:text] %></Font></Data>
          </Comment>
        <% end %>
        </Cell>
